<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="edu.kh.semi.board.model.mapper.BoardMapper">


	<!-- 게시판 글쓰기 -->
	<insert id="insertBoard" useGeneratedKeys="true" parameterType="Board">
		<selectKey order="BEFORE" resultType="_int" keyProperty="boardNo">
  			SELECT SEQ_BOARD_NO.NEXTVAL FROM DUAL
  		</selectKey>
		INSERT INTO "BOARD"
		VALUES(#{boardNo},
		#{boardTitle},
		#{boardContent},
		DEFAULT,
		NULL,
		DEFAULT,
		DEFAULT,
		#{boardCheckNotice},
		#{boardCheckPublic},
		#{memberNo})
	</insert>
	
	
	
	<select id="selectOne" resultType="Board">
		SELECT BOARD_TITLE ,BOARD_CONTENT, 
			TO_CHAR(BOARD_WRITE_DATE, 'YYYY"년" MM"월" DD"일" HH24:MI:SS') BOARD_WRITE_DATE,
			MEMBER_NICKNAME
		FROM BOARD
		JOIN "MEMBER" USING(MEMBER_NO)
		WHERE BOARD_NO = #{boardNo}
		AND BOARD_DEL_FL='N'
	</select>
	
	
	<select id="selectBoard">
		SELECT BOARD_NO, BOARD_TITLE, MEMBER_NICKNAME, READ_COUNT, BOARD_WRITE_DATE
		FROM BOARD
		JOIN "MEMBER" USING(MEMBER_NO)
		WHERE BOARD_DEL_FL='N'
		<choose>
			<when test='boardType=="member"'>
			AND BOARD_CHECK_NOTICE='N'
			AND BOARD_CHECK_PUBLIC='N'
			</when>
			
			<when test='boardType=="public"'>
			AND BOARD_CHECK_NOTICE='N'
			AND BOARD_CHECK_PUBLIC='Y'
			</when>
			
			<when test='boardType=="notice"'>
			AND BOARD_CHECK_NOTICE='Y'
			</when>
		</choose>
		ORDER BY BOARD_NO DESC
	</select>
	
	
	
		<!-- 게시물 수 세기 -->
	<select id="getListCount" resultType="_int">
		SELECT COUNT(*)
		FROM "BOARD"
		JOIN "MEMBER" USING(MEMBER_NO)
		WHERE BOARD_DEL_FL='N'
		<choose>
			<when test='boardType=="member"'>
			AND BOARD_CHECK_NOTICE='N'
			AND BOARD_CHECK_PUBLIC='N'
			</when>
			
			<when test='boardType=="public"'>
			AND BOARD_CHECK_NOTICE='N'
			AND BOARD_CHECK_PUBLIC='Y'
			</when>
			
			<when test='boardType=="notice"'>
			AND BOARD_CHECK_NOTICE='Y'
			</when>
		</choose>
		
	</select>
</mapper>
